{"version":3,"sources":["webpack:///src/app/pages/session-assignment-view/session-assignment-view.page.html","webpack:///src/app/pages/session-assignment-view/session-assignment-view-routing.module.ts","webpack:///src/app/pages/session-assignment-view/session-assignment-view.module.ts","webpack:///src/app/pages/session-assignment-view/session-assignment-view.page.scss","webpack:///src/app/pages/session-assignment-view/session-assignment-view.page.ts","webpack:///src/assets/js/ui/ui__input__camera.js","webpack:///src/assets/js/utils/utils__camera.js","webpack:///src/assets/js/utils/utils__checks.js","webpack:///src/assets/js/utils/utils__errors.js","webpack:///src/assets/js/utils/utils__logging.js","webpack:///src/assets/js/utils/utils__resize.js"],"names":["routes","path","component","SessionAssignmentViewPageRoutingModule","imports","forChild","exports","SessionAssignmentViewPageModule","declarations","SessionAssignmentViewPage","ngZone","nativeHttp","globalService","platform","sessionmypage","dms","router","activatedRoute","modalController","assignmentsService","storage","networkService","refreshvalue","segmentModel","console","log","isactiveassignment","token","getselectedtoken","studentid","getselectedStudentId","getAssignmentList","tutornamefordisplay","getselectedtutorname","brf_run","backButton","subscribeWithPriority","navigateByUrl","sessionid","brf_stop","sessionstatusended","SESSION_STATUS_ENDED","paramMap","subscribe","params","id","getAll","asgmtid","sessionstatus","getselectedsessionstatus","get","then","val","forEach","valor","asgmt_Id","asgmtlist","imgdisplayinapp","display","asgmt_Data","asgmtdiscusslist","assignmentDiscussions","event","header","fetchinfo","setDataSerializer","post","apiUrl","response","data","JSON","parse","set","test","assignments","valor2","test2","test3","created_On","target","complete","e","error","presentError","setTimeout","status","isactivevideoorvoice","ev","create","cssClass","backdropDismiss","popover","present","online","presentNetworkMsg","presentDrawing","res","setselectedasgmtid","presentModal","bImg","bypassSecurityTrustResourceUrl","componentProps","imagedisplay","discussimgdisplayinapp","asgmtDiscuss_Data","modal","selector","template","__brfv5__input","document","createElement","__brfv5__camera_canvas_0","__brfv5__camera_canvas_1","setAttribute","_name","_lastCameraConstraints","width","height","frameRate","facingMode","mirrored","_scaleMode","PROPORTIONAL_OUTSIDE","_isFirstOpenCameraCall","mountCamera","node","scaleMode","appendChild","className","window","addEventListener","onResize","hideCamera","classList","add","setSizeCamera","openCamera","constraints","restartStream","isVideoPaused","checkConstraintValue","Promise","resolve","reject","videoWidth","videoHeight","video","CAMERA_FAILED","msg","closeCamera","pause","silent","getDataFromCamera","input","canvas0","canvas1","paused","value","CameraFacingMode","USER","ENVIRONMENT","LEFT","RIGHT","_default480p","_videoConstraints","ideal","min","max","logName","getUserMedia","navigator","mediaDevices","mediaStream","srcObject","play","startCamera","videoConstraints","stopCamera","getTracks","track","stop","toggleCameraFacingMode","newMode","isVideo","errorMsg","isImage","image","naturalWidth","isCanvas","canvas","getContext","ERRORS","IMAGE_FAILED","SCENE_CREATION_FAILED","BRFV5_FAILED","_debug","setLogLevel","showDebug","args","apply","warn","ScaleMode","NO_SCALE","STRETCH","PROPORTIONAL_INSIDE","doResize","element","elementWidth","elementHeight","scale","ew","eh","rect","parentElement","getBoundingClientRect","rx","parseInt","left","ry","top","rw","right","rh","bottom","sh","sw","_scale","Math","abs","style","floor","transformOrigin","transform","getScale"],"mappings":"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","file":"pages-session-assignment-view-session-assignment-view-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <app-session-header></app-session-header>\\r\\n  <ion-segment [(ngModel)]=\\\"segmentModel\\\" (ionChange)=\\\"segmentChanged($event)\\\">\\r\\n    <ion-segment-button  class=\\\"{{isactivevideoorvoice}}\\\" value=\\\"conferencing\\\" >\\r\\n      <ion-label>Conferencing</ion-label>\\r\\n    </ion-segment-button>\\r\\n    <ion-segment-button class=\\\"{{isactiveassignment}}\\\" value=\\\"assignment\\\">\\r\\n      <ion-label>Assignment</ion-label>\\r\\n    </ion-segment-button>\\r\\n  </ion-segment>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-refresher slot='fixed' (ionRefresh)='UpdateData($event)'>\\r\\n    <ion-refresher-content></ion-refresher-content>\\r\\n    </ion-refresher>\\r\\n  <div *ngIf=\\\"segmentModel === 'conferencing'\\\">\\r\\n    <ion-col>\\r\\n    <div style=\\\"text-align: center;\\\">No Conference Call</div>\\r\\n    </ion-col>\\r\\n  </div>    \\r\\n    <div *ngIf=\\\"segmentModel === 'assignment'\\\">\\r\\n      <div class=\\\"thirdcontent\\\" >\\r\\n        \\r\\n        <div class=\\\"box\\\" *ngIf=\\\"asgmtlist&&this.sessionstatus!==this.sessionstatusended\\\">\\r\\n          <ion-label>\\r\\n            [{{asgmtlist.created_By_Username}}-{{asgmtlist.created_By_Level}}]  {{asgmtlist.asgmt_Title}} \\r\\n        </ion-label>\\r\\n        <ion-icon style=\\\"position: absolute;right:1em;zoom:1.3\\\" button src=\\\"assets/images/1001-cross.svg\\\" (click)=\\\"PreviousPage()\\\" ></ion-icon>\\r\\n        <br/>\\r\\n      </div>\\r\\n      <div class=\\\"boxSessionEnd\\\" *ngIf=\\\"asgmtlist&&this.sessionstatus===this.sessionstatusended\\\"> \\r\\n        <ion-label>\\r\\n          [{{asgmtlist.created_By_Username}}-{{asgmtlist.created_By_Level}}]  {{asgmtlist.asgmt_Title}} \\r\\n      </ion-label>\\r\\n      <ion-icon style=\\\"position: absolute;right:1em;zoom:1.3\\\" button src=\\\"assets/images/1001-cross.svg\\\" (click)=\\\"PreviousPage()\\\" ></ion-icon>\\r\\n      <br/>\\r\\n    </div>\\r\\n\\r\\n      <div class=\\\"center\\\">\\r\\n\\r\\n        <ion-card >\\r\\n          <b style=\\\"font-size: x-large;color:black\\\">Boredom, Frustration</b>\\r\\n          <ion-item>\\r\\n            <div id=\\\"__brfv5\\\" class=\\\"__brfv5\\\" hidden></div>\\r\\n            <ion-label id=\\\"emotion-evaluation\\\">\\r\\n              Test\\r\\n            </ion-label>\\r\\n          </ion-item>\\r\\n            <ion-card-content id=\\\"api-result\\\" style=\\\"font-size: large;color:black;padding: 0em;\\\">\\r\\n           Awaiting input for facial tracking...\\r\\n          </ion-card-content>\\r\\n        </ion-card>\\r\\n\\r\\n        <ion-card *ngIf=\\\"asgmtlist\\\">\\r\\n          <b style=\\\"font-size: x-large;color:black\\\">Question</b>\\r\\n          <ion-item>\\r\\n            <ion-img *ngIf=\\\"asgmtlist.asgmt_Data==null\\\" ionImgViewer style=\\\"width:10em;height:10em;\\\"  src=\\\"assets/images/noimage.png\\\"></ion-img>\\r\\n            <img (click)=\\\"presentModalImage(imgdisplayinapp)\\\" *ngIf=\\\"asgmtlist.asgmt_Data!=null\\\" style=\\\"width:10em;height:10em;\\\"  [src]=\\\"imgdisplayinapp\\\">\\r\\n            <ion-button *ngIf=\\\"asgmtlist.created_By===this.studentid&&this.sessionstatus!==this.sessionstatusended\\\" slot=\\\"end\\\" style=\\\"font-size: larger;color:white;\\\" (click)=\\\"EditDrawing()\\\">Edit</ion-button>\\r\\n          </ion-item>\\r\\n            <ion-card-content style=\\\"font-size: large;color:black;padding: 0em;\\\">\\r\\n           {{asgmtlist.asgmt_Value}}\\r\\n          </ion-card-content>\\r\\n        </ion-card>\\r\\n        <ion-card>\\r\\n          <b style=\\\"font-size: x-large;color:black\\\">Discussion</b>\\r\\n        <div class=\\\"scrolling-wrapper\\\">\\r\\n          <div *ngFor=\\\"let asgmtlist of asgmtdiscusslist\\\"  class=\\\"card\\\"><h2>\\r\\n            <ion-label style=\\\"font-size: medium;\\\">{{asgmtlist.created_On | date:'medium'}}</ion-label><br/>\\r\\n            <img style=\\\"width:10em;height:10em\\\" (click)=\\\"presentModalDiscussImage(asgmtlist.asgmtDiscuss_Data)\\\" *ngIf=\\\"asgmtlist.asgmtDiscuss_Data!=null\\\" [src]=\\\"this.display(asgmtlist.asgmtDiscuss_Data)\\\"><br/>\\r\\n            <ion-label style=\\\"font-size: medium;\\\" *ngIf=\\\"asgmtlist.created_By_Username!=null\\\">Commented By: <b>{{asgmtlist.created_By_Username}} ({{asgmtlist.created_By_Level}})</b></ion-label><br/>\\r\\n            <ion-label style=\\\"font-size: medium;\\\" *ngIf=\\\"asgmtlist.created_By_Username==null\\\">Commented By: <b>{{tutornamefordisplay}}</b></ion-label><br/>\\r\\n          </h2>\\r\\n        </div>\\r\\n        </div>\\r\\n        </ion-card>\\r\\n        </div>\\r\\n  </div>\\r\\n  <!-- </div> -->\\r\\n</div>\\r\\n</ion-content>\\r\\n<ion-footer>\\r\\n   <ion-fab-button *ngIf=\\\"segmentModel === 'assignment'&&asgmtlist\\\" (click)=\\\"StayonPage(asgmtlist.asgmt_Id)\\\"  vertical=\\\"end\\\" horizontal=\\\"end\\\" style=\\\"position: absolute;bottom: 1em;right: 1em;\\\"><img style=\\\"width:3em;height:3em;\\\" src=\\\"assets/images/chat-1.svg\\\"></ion-fab-button> \\r\\n</ion-footer>\\r\\n\\r\\n\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { SessionAssignmentViewPage } from './session-assignment-view.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: SessionAssignmentViewPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class SessionAssignmentViewPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { SessionAssignmentViewPageRoutingModule } from './session-assignment-view-routing.module';\r\nimport { SessionAssignmentViewPage } from './session-assignment-view.page';\r\nimport {ComponentsModule} from '../../components.module';\r\nimport { NgxIonicImageViewerModule } from 'ngx-ionic-image-viewer';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    SessionAssignmentViewPageRoutingModule,\r\n    NgxIonicImageViewerModule,\r\n    ComponentsModule\r\n  ],\r\n  declarations: [SessionAssignmentViewPage]\r\n})\r\nexport class SessionAssignmentViewPageModule {}\r\n","export default \".center {\\n  text-align: center;\\n}\\n\\n.scrolling-wrapper {\\n  overflow-x: scroll;\\n  overflow-y: hidden;\\n  white-space: nowrap;\\n}\\n\\n.scrolling-wrapper .card {\\n  display: inline-block;\\n}\\n\\nion-item {\\n  border: none;\\n  padding: 0em;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvc2Vzc2lvbi1hc3NpZ25tZW50LXZpZXcvQzpcXFVzZXJzXFxMMzA5MDNcXERvY3VtZW50c1xcR2l0SHViXFxJb25pY0ZQL3NyY1xcYXBwXFxwYWdlc1xcc2Vzc2lvbi1hc3NpZ25tZW50LXZpZXdcXHNlc3Npb24tYXNzaWdubWVudC12aWV3LnBhZ2Uuc2NzcyIsInNyYy9hcHAvcGFnZXMvc2Vzc2lvbi1hc3NpZ25tZW50LXZpZXcvc2Vzc2lvbi1hc3NpZ25tZW50LXZpZXcucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksa0JBQUE7QUNDSjs7QURDRTtFQUNFLGtCQUFBO0VBQ0Esa0JBQUE7RUFDQSxtQkFBQTtBQ0VKOztBREFJO0VBQ0UscUJBQUE7QUNFTjs7QURDRTtFQUNFLFlBQUE7RUFDQSxZQUFBO0FDRUoiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9zZXNzaW9uLWFzc2lnbm1lbnQtdmlldy9zZXNzaW9uLWFzc2lnbm1lbnQtdmlldy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY2VudGVye1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gIH1cclxuICAuc2Nyb2xsaW5nLXdyYXBwZXIge1xyXG4gICAgb3ZlcmZsb3cteDogc2Nyb2xsO1xyXG4gICAgb3ZlcmZsb3cteTogaGlkZGVuO1xyXG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcclxuICBcclxuICAgIC5jYXJkIHtcclxuICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gICAgfVxyXG4gIH1cclxuICBpb24taXRlbSB7XHJcbiAgICBib3JkZXI6bm9uZTtcclxuICAgIHBhZGRpbmc6IDBlbTtcclxuICB9IiwiLmNlbnRlciB7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuLnNjcm9sbGluZy13cmFwcGVyIHtcbiAgb3ZlcmZsb3cteDogc2Nyb2xsO1xuICBvdmVyZmxvdy15OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG4uc2Nyb2xsaW5nLXdyYXBwZXIgLmNhcmQge1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG59XG5cbmlvbi1pdGVtIHtcbiAgYm9yZGVyOiBub25lO1xuICBwYWRkaW5nOiAwZW07XG59Il19 */\";","import { Component, OnInit, NgZone } from '@angular/core';\r\nimport { ActivatedRoute,Router } from '@angular/router';\r\nimport { AssignmentsService } from '../../services/assignments.service';\r\nimport { ModalController, Platform } from '@ionic/angular';\r\nimport { SessionAssignmentChatPage } from '../../pages/session-assignment-chat/session-assignment-chat.page';\r\nimport { Storage } from '@ionic/storage';\r\nimport {NetworkService} from '../../services/network.service';\r\nimport {apiurl, SessionStatus} from '../../model/global-api';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { GlobalService} from '../../services/global.service';\r\nimport { SessionViewImageDiscussionPage } from '../shared-module/session-view-image-discussion/session-view-image-discussion.page';\r\nimport { SessionMyPage } from '../session-my/session-my.page';\r\nimport { Observable } from 'rxjs/internal/Observable';\r\nimport { HTTP } from '@ionic-native/http/ngx';\r\nimport { TestBed } from '@angular/core/testing';\r\nimport { run } from \"../../../assets/js/examples/face_tracking__track_one_face.js\";\r\nimport { closeCamera } from '../../../assets/js/ui/ui__input__camera.js'\r\n@Component({\r\n  selector: 'app-session-assignment-view',\r\n  templateUrl: './session-assignment-view.page.html',\r\n  styleUrls: ['./session-assignment-view.page.scss'],\r\n})\r\nexport class SessionAssignmentViewPage implements OnInit {\r\n  textdisplay: any;\r\n  assignlist: any;\r\n  ChangeDetectorRef: any;\r\n  test: any;\r\n  test2: any;\r\n  refreshvalue: boolean = false;\r\n  test3: any;\r\n\r\n  constructor(private ngZone:NgZone,private nativeHttp:HTTP,private globalService: GlobalService,private platform:Platform,private sessionmypage:SessionMyPage ,public dms:DomSanitizer,private router:Router,private activatedRoute: ActivatedRoute,private modalController:ModalController, private assignmentsService: AssignmentsService,private storage:Storage,private networkService:NetworkService) { }\r\n\r\n  //Segment\r\n  segmentModel = \"assignment\";isactiveassignment:string; isactivevideoorvoice:string;asgmtid:any;sessionid:any;\r\n //User Info\r\n token:any;studentid:any;tutornamefordisplay:any;\r\n  asgmtlist:any;sessionstatusended:any;sessionstatus:any;imgdisplayinapp:any;asgmtdiscusslist:any;discussimgdisplayinapp:any;\r\n  ngOnInit() { \r\n    //Segment\r\n    console.log('this.router.url','this.rout')\r\n  this.isactiveassignment=\"activesegment\";\r\n  }\r\n\r\n  ionViewWillEnter()\r\n  {\r\n    this.token=this.globalService.getselectedtoken()\r\n    this.studentid=this.globalService.getselectedStudentId()\r\n    this.getAssignmentList();\r\n    this.tutornamefordisplay=this.assignmentsService.getselectedtutorname()\r\n\r\n    // Starts brfv5 face tracking\r\n    this.brf_run();\r\n  }\r\n  ionViewDidEnter(){\r\n\r\n    this.platform.backButton.subscribeWithPriority(10, () => {\r\n      this.router.navigateByUrl('tabs/session-view/session-view/'+this.sessionid)\r\n    });\r\n  }\r\n  ionViewWillLeave() {\r\n    this.brf_stop();\r\n  }\r\n\r\n/*Get AssignmentList*/\r\n\r\n\r\n\r\ngetAssignmentList(){\r\n  this.sessionstatusended = SessionStatus.SESSION_STATUS_ENDED;\r\n   // Get the ID that was passed with the URL\r\n   this.activatedRoute.paramMap.subscribe(params => {\r\n     let id = params.getAll('id')\r\n     this.sessionid=id;\r\n   })\r\n  this.activatedRoute.paramMap.subscribe(params => {\r\n    let asgmtid = params.getAll('asgmtid')\r\n    this.asgmtid=asgmtid;\r\n  })\r\n\r\n  this.sessionstatus=this.assignmentsService.getselectedsessionstatus();\r\n  this.storage.get('assignmentdetails').then((val) => {\r\n      val.forEach((valor) => {\r\n      if(this.asgmtid==valor.asgmt_Id)\r\n      {\r\n        this.asgmtlist=valor;\r\n        this.imgdisplayinapp=this.display(valor.asgmt_Data)\r\n        this.asgmtdiscusslist=this.asgmtlist.assignmentDiscussions;\r\n\r\n      }\r\n    })\r\n  });\r\n\r\n}\r\n\r\n\r\n\r\nasync UpdateData(event)\r\n{\r\n  this.sessionstatusended = SessionStatus.SESSION_STATUS_ENDED;\r\n\r\n\r\n  this.token=this.globalService.getselectedtoken()\r\n  this.studentid=this.globalService.getselectedStudentId()\r\n  this.sessionstatus=this.assignmentsService.getselectedsessionstatus();\r\n\r\n  let header =  {'Accept': 'application/json','Content-Type': 'application/json' }\r\n  let fetchinfo = {\"Authentication_Token\":this.token, \"Student_Id\":this.studentid, \"inDepth\": \"Y\"}\r\n  this.nativeHttp.setDataSerializer('json');\r\n  this.nativeHttp.post(apiurl.apiUrl+'session/mySessions', fetchinfo,header).then( response => {\r\n   try {\r\n     response.data = JSON.parse(response.data);//whole asgmtlist of particular session ,returns a promise\r\n     this.storage.set('AssignmentDiscussion',response.data).then(val =>{\r\n      this.storage.get('AssignmentDiscussion').then((val) =>\r\n      {\r\n        // console.log('storage get',this.storage.get('AssignmentDiscussion'))\r\n        val.forEach((valor) => \r\n        {\r\n            this.test = valor.assignments;\r\n            this.test.forEach(valor2 => \r\n          {\r\n              this.test2 = valor2.asgmt_Id;\r\n            if(this.asgmtid==this.test2)\r\n            {\r\n              this.test = valor2.assignmentDiscussions;\r\n              this.test3 = valor2 \r\n              console.log('this is the apilist' , this.test.created_On)\r\n\r\n              this.imgdisplayinapp=this.display(this.test3.asgmt_Data)\r\n              this.asgmtdiscusslist=this.test;\r\n            }\r\n          });\r\n        })\r\n      })\r\n    event.target.complete();    \r\n    })\r\n } \r\n catch(e) {\r\n  console.error('JSON parsing error');\r\n  this.assignmentsService.presentError()\r\n  setTimeout(() => {\r\n   event.target.complete()\r\n   this.router.navigateByUrl('tabs/main');  \r\n\r\n }, 3000); \r\n}\r\n\r\n}).catch(response => {\r\n  // prints 403\r\n  console.log(response.status, ' errorsss');\r\n  // prints Permission denied\r\n  console.log(response.error, ' error');\r\n  this.assignmentsService.presentError()\r\n  setTimeout(() => {\r\n   event.target.complete()\r\n   this.router.navigateByUrl('tabs/main');  \r\n\r\n }, 3000);\r\n  });\r\n\r\n}\r\n\r\n  // refreshing(){\r\n  //   this.ngZone.run(() => {\r\n  //     this.refreshvalue = true;\r\n  //   })\r\n  // }\r\n\r\n\r\n  /*Segment */\r\n segmentChanged(event) {\r\n   if(this.segmentModel!=\"assignment\")\r\n   {\r\n   this.isactiveassignment=\"inactivesegment\";\r\n   this.isactivevideoorvoice=\"activesegment\";\r\n   this.brf_stop();\r\n   }\r\n   else if (this.segmentModel==\"assignment\"){\r\n     this.isactiveassignment=\"activesegment\";\r\n     this.isactivevideoorvoice=\"inactivesegment\";\r\n    this.brf_run();\r\n   }\r\n }\r\n/*Chat Pop up*/\r\nasync presentModal(ev: any) {\r\n  const popover = await this.modalController.create({\r\n    component: SessionAssignmentChatPage,\r\n    cssClass: 'small-modal',\r\n    backdropDismiss: true\r\n  });\r\n  return await popover.present();\r\n}\r\n/*Edit Drawing*/\r\nEditDrawing(){\r\n  if(this.networkService.online == false )\r\n  {\r\n    this.networkService.presentNetworkMsg(); \r\n  }\r\n  else{\r\n    this.assignmentsService.presentDrawing('Cancel','Confirm').then((res) => {\r\n      if (res === 'Confirm') {\r\n        this.router.navigateByUrl('/tabs/session-view/session-assignment-edit/'+this.sessionid+'/'+this.asgmtid);   \r\n        //Drawing Page\r\n      }\r\n     });\r\n  }\r\n  }\r\n   /*Open Chat*/\r\nStayonPage(asgmtid)\r\n{\r\n  if(this.networkService.online == false )\r\n  {\r\n    this.networkService.presentNetworkMsg(); \r\n  }\r\n  else{\r\n    this.assignmentsService.setselectedasgmtid(asgmtid);\r\n    this.presentModal(event);\r\n  }\r\n}\r\n  PreviousPage(){\r\n    if(this.networkService.online == false )\r\n    {\r\n      this.networkService.presentNetworkMsg(); \r\n    }\r\n    else{\r\n    this.router.navigateByUrl('/tabs/session-view/session-view/'+this.sessionid);\r\n    }  \r\n  }\r\n  //Image Sanitize\r\n  display(bImg:string)\r\n  {\r\n    return this.dms.bypassSecurityTrustResourceUrl(\"data:image/png;base64, \"+bImg)\r\n  }\r\n  //Display Image \r\n  async presentModalImage(imgdisplayinapp) {\r\n    const modal = await this.modalController.create({\r\n      component: SessionViewImageDiscussionPage,\r\n      componentProps: { \r\n        imagedisplay: this.imgdisplayinapp,\r\n        discussimgdisplayinapp:this.asgmtlist.asgmtDiscuss_Data\r\n      }\r\n    });\r\n    return await modal.present();\r\n  }\r\n  async presentModalDiscussImage(imgdisplayinapp) {\r\n    const modal = await this.modalController.create({\r\n      component: SessionViewImageDiscussionPage,\r\n      componentProps: { \r\n        imagedisplay: this.display(imgdisplayinapp),\r\n      }\r\n    });\r\n    return await modal.present();\r\n  }\r\n  //Opens camera and begins brfv5 face tracking\r\n  brf_run() {\r\n    // run();\r\n    console.log(\"brfv5 started\")\r\n  }\r\n  // Stops camera and brfv5\r\n  brf_stop() {\r\n    closeCamera();\r\n    console.log(\"camera closed\")\r\n  }\r\n  \r\n}\r\n","import { log }                  from '../utils/utils__logging.js'\r\n\r\nimport { startCamera }          from '../utils/utils__camera.js'\r\nimport { stopCamera }           from '../utils/utils__camera.js'\r\nimport { _default480p }         from '../utils/utils__camera.js'\r\n\r\nimport { doResize, ScaleMode }  from '../utils/utils__resize.js'\r\n\r\nimport { ERRORS }               from '../utils/utils__errors.js'\r\n\r\nconst __brfv5__input            = document.createElement('video')\r\nconst __brfv5__camera_canvas_0  = document.createElement('canvas')\r\nconst __brfv5__camera_canvas_1  = document.createElement('canvas')\r\n\r\n__brfv5__camera_canvas_0.id     = '__brfv5__camera_canvas_0'\r\n__brfv5__camera_canvas_1.id     = '__brfv5__camera_canvas_1'\r\n\r\n__brfv5__input.setAttribute('playsinline', true)\r\n__brfv5__input.setAttribute('muted', true)\r\n\r\nconst _name                     = 'BRFv5CameraCanvas'\r\n\r\nconst _lastCameraConstraints    = { width: 640, height: 480, frameRate: 30, facingMode: 'user', mirrored: true }\r\n\r\nlet _scaleMode                  = ScaleMode.PROPORTIONAL_OUTSIDE\r\nlet _isFirstOpenCameraCall      = true\r\n\r\nexport const mountCamera = (node, scaleMode) => {\r\n\r\n  log(_name + ': mountCamera')\r\n\r\n  if(node && node.appendChild) {\r\n\r\n    _scaleMode = scaleMode\r\n\r\n    __brfv5__input.className            = 'bg-t abs cm'\r\n    __brfv5__camera_canvas_0.className  = 'bg-t abs vh c'\r\n    __brfv5__camera_canvas_1.className  = 'bg-t abs vh c'\r\n\r\n    node.appendChild(__brfv5__input)\r\n    node.appendChild(__brfv5__camera_canvas_0)\r\n    node.appendChild(__brfv5__camera_canvas_1)\r\n\r\n    window.addEventListener(\"resize\", onResize)\r\n  }\r\n}\r\n\r\nexport const hideCamera = () => {\r\n\r\n  log(_name + ': hideCamera')\r\n\r\n  __brfv5__camera_canvas_0.classList.add('vh')\r\n  __brfv5__camera_canvas_1.classList.add('vh')\r\n}\r\n\r\nexport const setSizeCamera = (width, height) => {\r\n\r\n  log(_name + ': setSizeCamera:', width, height)\r\n\r\n  __brfv5__camera_canvas_0.width  = width\r\n  __brfv5__camera_canvas_0.height = height\r\n  __brfv5__camera_canvas_1.width  = width\r\n  __brfv5__camera_canvas_1.height = height\r\n\r\n  onResize()\r\n}\r\n\r\nconst onResize = () => {\r\n\r\n  const width  = __brfv5__camera_canvas_0.width\r\n  const height = __brfv5__camera_canvas_0.height\r\n\r\n  doResize(__brfv5__input,           width, height, _scaleMode)\r\n  doResize(__brfv5__camera_canvas_0, width, height, _scaleMode)\r\n  doResize(__brfv5__camera_canvas_1, width, height, _scaleMode)\r\n}\r\n\r\nexport const openCamera = (constraints) => {\r\n\r\n  log(_name + ': openCamera:', constraints)\r\n\r\n  if(!constraints) constraints = _default480p\r\n\r\n  let restartStream = _isFirstOpenCameraCall || isVideoPaused()\r\n\r\n  restartStream     = checkConstraintValue('width',      constraints) || restartStream\r\n  restartStream     = checkConstraintValue('height',     constraints) || restartStream\r\n  restartStream     = checkConstraintValue('frameRate',  constraints) || restartStream\r\n  restartStream     = checkConstraintValue('facingMode', constraints) || restartStream\r\n  restartStream     = checkConstraintValue('mirrored',   constraints) || restartStream\r\n\r\n  _isFirstOpenCameraCall = false\r\n\r\n  return new Promise((resolve, reject) => {\r\n\r\n    if(!restartStream) { resolve({\r\n      width:  __brfv5__input.videoWidth,\r\n      height: __brfv5__input.videoHeight }); return }\r\n\r\n    startCamera(__brfv5__input, _lastCameraConstraints).then(({ video }) => {\r\n\r\n      resolve({ width: video.videoWidth, height: video.videoHeight })\r\n\r\n    }).catch((e) => {\r\n\r\n      reject({ error: ERRORS.CAMERA_FAILED, msg: e })\r\n    })\r\n  })\r\n}\r\n\r\nexport const closeCamera = (pause = true, silent = false) => {\r\n\r\n  log(_name + ': closeCamera:', pause, silent)\r\n\r\n  stopCamera(__brfv5__input, pause, silent)\r\n  hideCamera()\r\n}\r\n\r\nexport const getDataFromCamera = () => {\r\n\r\n  return { input: __brfv5__input, canvas0: __brfv5__camera_canvas_0, canvas1: __brfv5__camera_canvas_1 }\r\n}\r\n\r\nexport const isVideoPaused = () => { return __brfv5__input.paused }\r\n\r\nconst checkConstraintValue = (value, constraints) => {\r\n\r\n  if(constraints[value] && _lastCameraConstraints[value] !== constraints[value]) {\r\n\r\n    _lastCameraConstraints[value] = constraints[value]\r\n\r\n    return true\r\n  }\r\n\r\n  return false\r\n}\r\n\r\nexport default {\r\n  mountCamera,\r\n  hideCamera,\r\n  setSizeCamera,\r\n  openCamera,\r\n  closeCamera,\r\n  getDataFromCamera,\r\n  isVideoPaused\r\n}\r\n","import { log, warn }        from './utils__logging.js'\r\nimport { isVideo }          from './utils__checks.js'\r\n\r\nexport const CameraFacingMode = {\r\n\r\n  USER:                     \"user\",\r\n  ENVIRONMENT:              \"environment\",\r\n  LEFT:                     \"left\",\r\n  RIGHT:                    \"right\"\r\n};\r\n\r\nexport const _default480p   = { width:  640, height:  480, frameRate: 30, facingMode: CameraFacingMode.USER }\r\n\r\nconst _videoConstraints     = {\r\n\r\n  width:                    { ideal: 640, min: 640, max: 1920 },\r\n  height:                   { ideal: 480, min: 480, max: 1080 },\r\n  frameRate:                { ideal:  30,           max: 30 },\r\n  facingMode:               { ideal: CameraFacingMode.USER }\r\n};\r\n\r\nconst logName               = 'utils__camera: '\r\n\r\nconst getUserMedia = (video) => {\r\n\r\n  return new Promise((resolve, reject) => {\r\n\r\n    window.navigator.mediaDevices.getUserMedia({ video: _videoConstraints })\r\n      .then((mediaStream) => {\r\n\r\n        video.srcObject = mediaStream\r\n        video.play().then(() => { resolve({ video: video }) }).catch((e) => { reject(e) })\r\n\r\n      }).catch((e) => { reject(e) })\r\n\r\n  }) // catch must be added after then, so then isn't called\r\n}\r\n\r\nexport const startCamera = (video, videoConstraints) => {\r\n\r\n  if(!isVideo(video, logName + 'startCamera: Provide a HTML video element to start the camera stream.' )) {\r\n\r\n    return\r\n  }\r\n\r\n  stopCamera(video, false, true)\r\n\r\n  if(!videoConstraints)           { videoConstraints = _default480p }\r\n\r\n  if(videoConstraints.width)      { _videoConstraints.width.ideal       = videoConstraints.width }\r\n  if(videoConstraints.height)     { _videoConstraints.height.ideal      = videoConstraints.height }\r\n  if(videoConstraints.frameRate)  { _videoConstraints.frameRate.ideal   = videoConstraints.frameRate }\r\n  if(videoConstraints.facingMode) { _videoConstraints.facingMode.ideal  = videoConstraints.facingMode }\r\n\r\n  log(logName + 'startCamera:', _videoConstraints)\r\n\r\n  return getUserMedia(video)\r\n}\r\n\r\nexport const stopCamera = (video, pause = true, silent = false) => {\r\n\r\n  if(!silent) {\r\n\r\n    log(logName + 'stopCamera')\r\n  }\r\n\r\n  if(!isVideo(video, logName + 'stopCamera: Provide a HTML video element to stop the camera stream.' )) {\r\n\r\n    return\r\n  }\r\n\r\n  const mediaStream = video.srcObject\r\n\r\n  if(mediaStream) {\r\n\r\n    mediaStream.getTracks().forEach((track) => { track.stop() })\r\n\r\n  } else if(!silent) {\r\n\r\n    warn(logName + 'stopCamera: No mediaStream attached to video.')\r\n  }\r\n\r\n  if(pause && !video.paused) {\r\n\r\n    video.pause()\r\n  }\r\n}\r\n\r\nexport const toggleCameraFacingMode = (video) => {\r\n\r\n  log(logName + 'toggleCameraFacingMode')\r\n\r\n  if(!isVideo(video, logName + 'toggleCameraFacingMode: Provide a HTML video element to toggle the facing mode.')) {\r\n\r\n    return\r\n  }\r\n\r\n  const newMode = _videoConstraints.facingMode.ideal === CameraFacingMode.USER ? CameraFacingMode.ENVIRONMENT : CameraFacingMode.USER\r\n\r\n  log(logName + 'toggleCameraFacingMode: to ' + newMode)\r\n\r\n  return startCamera(video, { facingMode: newMode })\r\n}\r\n\r\nexport default { startCamera, stopCamera, toggleCameraFacingMode }\r\n","import  { error } from './utils__logging.js'\r\n\r\nexport const isVideo = (video, errorMsg) => {\r\n\r\n  if(!video || !video.play) {\r\n\r\n    error(errorMsg)\r\n\r\n    return false\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nexport const isImage = (image, errorMsg) => {\r\n\r\n  if(!image || !image.naturalWidth) {\r\n\r\n    error(errorMsg)\r\n\r\n    return false\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nexport const isCanvas = (canvas, errorMsg) => {\r\n\r\n  if (!canvas || !canvas.getContext) {\r\n\r\n    error(errorMsg)\r\n\r\n    return false\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nexport default { isVideo, isImage, isCanvas }\r\n","export const ERRORS = {\r\n\r\n  CAMERA_FAILED:                          -10, // Failed to access the camera, either no camera attached or forbidden by user.\r\n  IMAGE_FAILED:                           -11, // Failed to load an image.\r\n  SCENE_CREATION_FAILED:                  -12, // no WebGL support? Device/Browser too old?\r\n  BRFV5_FAILED:                           -13  // no WebAssembly support? Device/Browser too old?\r\n};\r\n\r\nexport default { ERRORS }\r\n","let _debug = true\r\n\r\nexport const setLogLevel  = (showDebug) => { _debug = showDebug }\r\nexport const log          = (...args)   => { if(_debug) { console.log.apply(null, args) } }\r\nexport const warn         = (...args)   => { if(_debug) { console.warn.apply(null, args) } }\r\nexport const error        = (...args)   => { console.error.apply(null, args) }\r\n\r\nexport default { log, warn, error, setLogLevel }\r\n","export const ScaleMode      = {\r\n  NO_SCALE:                 0,\r\n  STRETCH:                  1,\r\n  PROPORTIONAL_INSIDE:      2,\r\n  PROPORTIONAL_OUTSIDE:     3\r\n};\r\n\r\nexport const doResize = (element, elementWidth, elementHeight, scaleMode, scale) => {\r\n\r\n  const ew    = elementWidth\r\n  const eh    = elementHeight\r\n\r\n  const rect  = element.parentElement.getBoundingClientRect()\r\n\r\n  const rx    = parseInt(rect.left)\r\n  const ry    = parseInt(rect.top)\r\n  const rw    = parseInt(rect.right)  - rx\r\n  const rh    = parseInt(rect.bottom) - ry\r\n\r\n  let   sh    = rh;\r\n  let   sw    = sh / eh * ew;\r\n\r\n  if(scaleMode === ScaleMode.NO_SCALE) {\r\n\r\n    sw = ew\r\n    sh = eh\r\n\r\n  } else if(scaleMode === ScaleMode.STRETCH) {\r\n\r\n    sw = rw\r\n\r\n  } else if(scaleMode === ScaleMode.PROPORTIONAL_INSIDE) {\r\n\r\n    if(sw > rw) {\r\n\r\n      sw    = rw\r\n      sh    = sw / ew * eh\r\n    }\r\n\r\n  } else if(scaleMode === ScaleMode.PROPORTIONAL_OUTSIDE) {\r\n\r\n    if(sw < rw) {\r\n\r\n      sw    = rw\r\n      sh    = sw / ew * eh\r\n    }\r\n  }\r\n\r\n  if(scale) {\r\n\r\n    let _scale = 1.0\r\n\r\n    if(Math.abs(rw - sw) < 0.1) {\r\n\r\n      _scale = sh / eh\r\n\r\n    } else {\r\n\r\n      _scale = sw / ew\r\n    }\r\n\r\n    element.style.left  = Math.floor((rw - sw) * 0.5) + 'px'\r\n    element.style.top   = Math.floor((rh - sh) * 0.5) + 'px'\r\n    element.style.transformOrigin = '0 0'\r\n\r\n    if(rw > rh) {\r\n      element.style.transform = 'scale(' + (_scale) + ')'\r\n    } else {\r\n      element.style.transform = 'scale(' + (_scale) + ')'\r\n    }\r\n\r\n  } else {\r\n\r\n    element.style.width  = sw + \"px\"\r\n    element.style.height = sh + \"px\"\r\n  }\r\n}\r\n\r\nexport const getScale = (element, elementWidth, elementHeight, scaleMode) => {\r\n\r\n  const ew    = elementWidth\r\n  const eh    = elementHeight\r\n\r\n  const rect  = element.parentElement.getBoundingClientRect()\r\n\r\n  const rx    = parseInt(rect.left)\r\n  const ry    = parseInt(rect.top)\r\n  const rw    = parseInt(rect.right)  - rx\r\n  const rh    = parseInt(rect.bottom) - ry\r\n\r\n  let   sh    = rh;\r\n  let   sw    = sh / eh * ew;\r\n\r\n  if(scaleMode === ScaleMode.NO_SCALE) {\r\n\r\n    sw = ew\r\n    sh = eh\r\n\r\n  } else if(scaleMode === ScaleMode.STRETCH) {\r\n\r\n    sw = rw\r\n\r\n  } else if(scaleMode === ScaleMode.PROPORTIONAL_INSIDE) {\r\n\r\n    if(sw > rw) {\r\n\r\n      sw    = rw\r\n      sh    = sw / ew * eh\r\n    }\r\n\r\n  } else if(scaleMode === ScaleMode.PROPORTIONAL_OUTSIDE) {\r\n\r\n    if(sw < rw) {\r\n\r\n      sw    = rw\r\n      sh    = sw / ew * eh\r\n    }\r\n  }\r\n\r\n  return sw / rw\r\n}\r\n\r\nexport default { ScaleMode, doResize, getScale }\r\n"]}